<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-ripple/paper-ripple.html">
<link rel="import" href="/bower_components/polymerfire/firebase-app.html">
<link rel="import" href="/bower_components/polymerfire/firebase-query.html">

<link rel="import" href="../bower_components/paper-fab-speed-dial/paper-fab-speed-dial.html">
<link rel="import" href="../bower_components/paper-fab-speed-dial/paper-fab-speed-dial-action.html">
<link rel="import" href="../bower_components/paper-badge/paper-badge.html">

<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/iron-iconset/iron-iconset.html">
<link rel="import" href="app-icons.html">

<link rel="import" href="w3-styles.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="theme-styles.html">

<link rel="lazy-import" href="daily-thoughts.html">
<link rel="lazy-import" href="company-thoughts.html">
<link rel="lazy-import" href="ldp-companies.html">
<link rel="lazy-import" href="leadership-thoughts.html">
<link rel="lazy-import" href="leadership-articles.html">
<link rel="lazy-import" href="master-class.html">
<link rel="lazy-import" href="topleader-thoughts.html">
<link rel="lazy-import" href="leadership-podcasts.html">
<link rel="lazy-import" href="leadership-videos.html">
<link rel="lazy-import" href="leadership-ebooks.html">
<link rel="lazy-import" href="company-profile.html">
<link rel="lazy-import" href="company-staff.html">
<link rel="lazy-import" href="thoughts-management.html">
<link rel="lazy-import" href="read-articles.html">
<link rel="lazy-import" href="add-thoughts.html">
<link rel="lazy-import" href="add-article.html">
<link rel="lazy-import" href="add-podcast.html">
<link rel="lazy-import" href="add-video.html">
<link rel="lazy-import" href="add-voicemail.html">
<link rel="lazy-import" href="not-found.html">
<link rel="lazy-import" href="sign-in.html">
<link rel="lazy-import" href="my-pldp.html"> 
<link rel="lazy-import" href="about-pldp.html"> 
<link rel="import" href="user-profile.html">
<link rel="import" href="my-followers.html">
<link rel="import" href="my-notifications.html">
<link rel="import" href="sidebar-menus.html">


<dom-module id="my-app">
	<template>
		<firebase-auth id="auth" user="{{_user}}" provider="google" status-known="{{statusKnown}}" on-error="handleError">
		</firebase-auth>
		<style include="shared-styles"></style>
		<style include="theme-styles"></style>
		<style include="w3-styles">
			:host {
				--app-primary-color: #4285f4;
				--app-theme-color: #c3272e;
				--app-secondary-color: black;
				--app-menu-text: #fff;
				display: block;
			}

			#main-header{
				position: fixed;
				left:280px; top:0px; right:0px;
				z-index:10;
				height:50px;
				background-color: #c3272e;
				color: #fff;
				/* background-image: url(/images/header.png); */
				background-position: right;
				background-repeat: no-repeat;
			}

			#main-header .w3-padding-large{
				padding: 13px 24px !important;
			}

			#sidebar{
				position: fixed;
				left:0px; top:0px; bottom:0px;
				z-index:10;
				width:280px;
				background-color: #222d32;
				overflow-y: auto;
				overflow-x: hidden;
			}

			#sidebar-menu{
				display: none;
			} 

			paper-fab-speed-dial{
				bottom: 0px;
				right: 12px;
				position: fixed;
			}

			paper-fab-speed-dial-action{
				cursor: pointer;
			}

			paper-fab-speed-dial-action .flex .label{
				background-color: #0b908b;
				color:#fff;
				box-shadow: 0px 0px 5px rgba(0,0,0,0.5);
			}

			iron-selector a{
				text-decoration: none;
				display: block;
				padding:7px 5px;
				position: relative;
			}

			.a-border-top{
				border-top: 1px solid rgba(255,255,255, 0.05);
			}

			iron-selector a .sb-link-icon, iron-selector a .sb-link-text{
				color:#fff;
			}

			iron-selector a .sb-link-text{
				padding: 10px 10px;
				font-size: 10pt;
			}

			iron-selector a:hover{
				background-color: rgba(255,255,255,0.05);
			}

			iron-selector a iron-icon{
				color:#fff;
			}

			#main-content{
				min-height:100vh;
				margin-left:280px;
				padding:15px;
				margin-top: 50px;
			}

			.user-pic{
				width:60px;
				border:4px solid var(--app-theme-color);
			}

			.user-pic:hover{
				cursor: pointer;
				border:4px solid var(--app-theme-color);
			}

			.user-name{
				padding-top:17px !important;
				font-size:12px;
			}

			.user-email{
				padding-top:3px;
			}

			.w3-padding-tiny{
				padding:2px;
			}

			.w3-relative{
				position: relative;
			}

			#user-identity{
				position: relative;
				z-index: 10;
				margin-top: -28px;
			}

			#mobile-logo{
				display: none;
			}
			.mobilelogo{
				/* height: 50px; */
				/* width: 192px; */
				height: 74px;
				background-position: center;
				background-size: contain;
				background-repeat: no-repeat;
			}
			.oneconnectlogo{
				height: 45px;
				background-position: center;
				background-size: contain;
				background-repeat: no-repeat;
			}

			@media (max-width: 780px){
				#sidebar{
					display:none;
					position: fixed;
					z-index: 999;
					left:0px;
				}

				#main-header{
					left: 0px;
					height: 81px;
				}

				#main-content{
					margin-left: 0px;
					padding:10px;
					margin-top: 81px !important;
				}

				#sidebar-menu{
					display: unset;
				}

				#mobile-logo{
					display: block;
				}

				#close-side-bar{
					display: block;
				}
			}

			.sub-price{
				cursor: pointer;
			}

			.w3-bolded{
				font-weight: 700;	
			}

			.w3-editable{
				position: relative;
			}

			.w3-editable .editable{
				opacity: 0.95;
				position: absolute; 
				cursor: pointer;
				top: 12px;
				text-align: center;
				right: 0px;
				background-color: var(--app-theme-color);
				border-radius:50%;
			}

			.w3-editable:hover .editable{
				opacity: 1;
			}

			.pricing-holder .w3-container-fluid .w3-row:nth-child(even){
				background-color: rgba(0,0,0,0.06);
			}

			@media(min-width: 780px){
				#sidebar{
					display:block;
				}

				#close-side-bar{
					display: none;
				}
			}
			
			@media(max-width: 359px){
				.mobilelogo{
					height: 74px;
					background-position: center;
					background-size: contain;
					background-repeat: no-repeat;
				}
				.oneconnectlogo{
					height: 45px;
					background-position: center;
					background-size: contain;
					background-repeat: no-repeat;
				}
			}

			@media(max-width: 320px){
				.mobilelogo{
					height: 70px;
					background-position: center;
					background-size: contain;
					background-repeat: no-repeat;
				}
				.oneconnectlogo{
					height: 45px;
					background-position: center;
					background-size: contain;
					background-repeat: no-repeat;
				}
			}

			@media(max-width: 300px){
				.mobilelogo{
					height: 64px;
					background-position: center;
					background-size: contain;
					background-repeat: no-repeat;
				}
				.oneconnectlogo{
					height: 45px;
					background-position: center;
					background-size: contain;
					background-repeat: no-repeat;
				}
			}

		</style>

		<app-location
				route="{{route}}"
				url-space-regex="^[[rootPath]]">
		</app-location>

		<app-route
			route="{{route}}"
			pattern="[[rootPath]]:page"
			data="{{routeData}}"
			tail="{{subroute}}">
		</app-route>

		<template is="dom-if" if="[[_companyid]]">
			<firebase-query
				id="qrycompany"
				path="/companies"
				order-by-child="companyID"
				start-at="[[_companyid]]"
				limit-to-first="1"
				data="{{companyData}}">
			</firebase-query>

			<firebase-query
				id="qryuser"
				path="/users"
				order-by-child="uid"
				equal-to="[[_user.uid]]"
				data="{{userData}}">
			</firebase-query>

			<firebase-query
				id="qryusernotifications"
				path="/users/[[_userID]]/notifications"
				limit-to-last="20"
				data="{{userNotificationData}}">
			</firebase-query>

		</template>
		<div class="w3-row" fullbleed>
			<div class="w3-animate-left w3-display-container" id="sidebar">
				<span class="w3-display-topright w3-padding-small w3-text-grey" on-click="_sideBarClose" id="close-side-bar">
					<paper-ripple></paper-ripple>
					<iron-icon icon="smapp:arrow-back"></iron-icon>
				</span>
				<!-- <div style$="background-image: url('/images/app-sidebar.png'); height:130px; {{companyBgColor}}" class="w3-padding"> -->
				<div class="w3-padding-small" style="height:160px; background-color:#fff;display: flex;
				flex-direction: column;justify-content: center;align-items: center;">
				<img src$="{{companyLogo}}" style="width: 100%" class="w3-padding-top">
				</div>
				<div id="user-identity" class="w3-text-white">
					<div class="w3-row w3-padding-top">
						<div class="w3-left w3-padding-small w3-editable" on-tap="_openUserProfile">
							<img src="{{userLogo}}" class="user-pic w3-circle" />
							<div class="editable">
								<iron-icon icon="smapp:create"></iron-icon>
							</div>
						</div>
						<div class="w3-margin-top w3-padding-small w3-rest">
							<div class="user-name w3-medium" style$="{{menuTextColor}}">{{fullName}}</div>
							<!-- <div class="user-email">[[user.email]]</div> -->
						</div>
					</div>
					<div class="w3-row w3-padding w3-sb-title follow w3-hover-dark-grey" style="position:relative;">
						<div id="openFollowers" class="w3-col s6 w3-center" on-tap="_openModal" data="my-followers" style="position:relative; cursor: pointer;">
							<span class="w3-badge w3-small w3-light-grey">{{no_followers}}</span> Followers
						</div>
						<div id="openFollowing" class="w3-col s6 w3-center" on-tap="_openModal" data="my-followers" style="cursor: pointer;">
							<span class="w3-badge w3-small w3-light-grey">{{no_following}}</span> Following
						</div>
						<paper-ripple></paper-ripple>
					</div>
				</div>
				<sidebar-menus id="sidebarMenu" hidecompany="[[hidecompany]]" notcompanyadmin="[[notcompanyadmin]]" pendingstring="{{pending_string}}" leadershipapp="[[leadershipapp]]" publicapp="[[publicapp]]" salesapp="[[salesapp]]" hrapp="[[hrapp]]" on-tap="_sideBarClicked"></sidebar-menus>
				<div class="w3-text-white">
					<br>
					<div class="w3-row">
						<a on-tap="logout" href="[[rootPath]]" style="display: block; text-decoration: none; width:100%" class="w3-left a-border-top">
							<paper-button class="w3-text-light-grey w3-hover-deep-orange w3-center" style="min-width:92% !important">
								<iron-icon icon="smapp:input"></iron-icon>
								Sign Out
							</paper-button>
						</a>
					</div>
				</div>
			</div>
			<div class="w3-rest" id="main-content" on-click="_closeSidebarFromBody">
				<div class="w3-row" id="main-header" style$="{{companyBgColor}}; {{menuTextColor}}">
					<!-- <div class="w3-padding w3-right w3-relative" on-click="unshortedURL">
						<iron-icon icon="app:message"></iron-icon>
						<span class="w3-hide-small">UnShorten URL</span>
					</div> -->
					<div data="send-feedback" class="w3-padding-small w3-right w3-relative" on-click="_openModal">
						<paper-ripple></paper-ripple>
						<iron-icon icon="app:message"></iron-icon>
						<span class="w3-hide-small">FeedBack</span>
					</div>
					<div id="open-notifications" data="my-notifications" class="w3-padding-small w3-right w3-relative" on-click="_openModal">
						<paper-ripple></paper-ripple>
						<iron-icon on-click="_openModal" data="my-notifications" id="notificationIcon" icon="app:notifications"></iron-icon>
						<div class="w3-new-badge nt"
							style="left:22px!important; top:2px!important; z-index:222; position:absolute;background-color: #0085a5;">
							{{unread_string}}
						</div>
						<span class="w3-padding-small w3-hide-small">Notifications</span>
					</div>
					<div class="w3-padding-small w3-left w3-relative w3-relative" id="sidebar-menu" on-click="_sideBarOpen" style="z-index: 999;">
						<paper-ripple></paper-ripple>
						<iron-icon icon="app:menu"></iron-icon>
					</div>
					<div class="w3-padding-small w3-center" id="mobile-logo">
						<!-- OneConnect -->
						<template is="dom-if" if="[[isEqual(_companyid, '-LDVbbRyIMhukVtTVQ0n')]]">
							<img class="oneconnectlogo" src$="{{companyLogo}}">
						</template>
						<!-- Global Leadership Platform -->
						<template is="dom-if" if="[[isEqual(_companyid, '-KgsUcgfo7z1U9MXgd9i')]]">
							<div style="background-image: url('{{companyLogo}}');" class="mobilelogo"></div>
						</template>
						<!-- Other Companies -->
						<template is="dom-if" if="[[isEqual(_companyid, '12345')]]">
							<img class="oneconnectlogo" src$="{{companyLogo}}">
						</template>
						
					</div>
				</div>
				<iron-pages
						selected="{{page}}"
						attr-for-selected="name"
						fallback-selection="not-found"
						role="main">
					<company-thoughts name="company-thoughts" _companyid="[[_companyid]]" user="[[user]]"></company-thoughts>
					<daily-thoughts name="daily-thoughts" _companyid="[[_companyid]]" user="[[user]]"></daily-thoughts>
					<leadership-thoughts company="[[company]]" name="leadership-thoughts" _companyid="[[_companyid]]" user="[[user]]"></leadership-thoughts>
					<leadership-articles name="leadership-articles" _companyid="[[_companyid]]" user="[[user]]"></leadership-articles>
					<!-- <master-class name="master-class" _companyid="[[_companyid]]" user="[[user]]"></master-class> -->
					<ldp-companies name="ldp-companies" user="[[user]]"></ldp-companies>
					<topleader-thoughts name="topleader-thoughts" _companyid="[[_companyid]]" user="[[user]]"></topleader-thoughts>
					<leadership-podcasts name="leadership-podcasts" _companyid="[[_companyid]]" user="[[user]]"></leadership-podcasts>
					<leadership-videos name="leadership-videos" _companyid="[[_companyid]]" user="[[user]]"></leadership-videos>
					<leadership-ebooks name="leadership-ebooks" _companyid="[[_companyid]]" user="[[user]]"></leadership-ebooks>
					<company-profile name="company-profile" _companyid="[[_companyid]]" user="[[user]]"></company-profile>
					<company-staff name="company-staff" _companyid="[[_companyid]]" user="[[user]]"></company-staff>
					<thoughts-management name="thoughts-management" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></thoughts-management>
					<my-pldp name="my-pldp" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></my-pldp>
					<about-pldp name="about-pldp" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></about-pldp>
					<add-thoughts name="add-thoughts" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]" addedit="[[addedit]]" company="[[company]]"></add-thoughts>
					<add-article name="add-article" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></add-article>
					<read-articles name="read-articles" _companyid="[[_companyid]]" user="[[user]]" author="[[bookAuthor]]" title="[[bookTitle]]" body="[[bookBody]]" photo="[[bookPhoto]]"></read-articles>
					<add-podcast name="add-podcast" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></add-podcast>
					<add-video name="add-video" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></add-video>
					<add-voicemail name="add-voicemail" _companyid="[[_companyid]]" user="[[user]]" previouspage="[[previousPage]]"></add-voicemail>
				</iron-pages>
			</div>
		</div>
		<div id="send-feedback" class="w3-modal w3-animate-zoom">
			<div class="w3-modal-content w3-round max-modal-width" >
				<div class="w3-container">
					<span id="close-feedback" data="send-feedback" on-click="_closeModal" class="w3-button w3-display-topright w3-medium w3-red w3-text-white">&times;</span>
					<div class="w3-large" style="padding:20px 15px">
						<b class="w3-text-dark-grey"><iron-icon icon="app:message"></iron-icon> Send us Feedback</b>
					</div>
					<div class="w3-row w3-padding-large">
						<paper-input id="feedbackSubject" label="Subject" auto-validate></paper-input>
					</div>
					<div class="w3-row w3-padding-large">
						<paper-textarea id="feedbackMessage" rows="2" multiple label="Feedback" auto-validate></paper-textarea>
					</div>
					<div class="w3-row w3-padding-large">
						<div class="w3-twothird"><paper-button raised class="w3-blue" on-tap="sendFeedback">
							<iron-icon icon="app:send"></iron-icon>&nbsp;Send Feedback</paper-button>
						</div>
						<div class="w3-third"></div>
					</div>
				</div>
			</div>
		</div>
		<div id="level-users" class="w3-modal w3-animate-zoom">
			<div class="w3-modal-content w3-round max-modal-width">
				<div class="w3-container">
					<span id="close-levelusers" data="level-users" on-click="_closeModal" class="w3-button w3-display-topright w3-medium w3-red w3-text-white">&times;</span>
					<div class="w3-large" style="padding:20px 15px">
						<b class="w3-text-blue"><iron-icon icon="app:group-add"></iron-icon>&nbsp;Level of Users</b>
					</div>
					<div class="w3-row w3-margin-bottom">
						<ul class="w3-ul w3-hoverable" style="cursor:pointer;">
							<li>
								<iron-icon class="w3-text-yellow" icon="app:star-border"></iron-icon>
								<iron-icon class="w3-text-yellow" icon="app:star-border"></iron-icon>
								<iron-icon class="w3-text-yellow" icon="app:star-border"></iron-icon>
								&nbsp;Standard User
							</li>
							<li>
								<iron-icon class="w3-text-yellow" icon="app:star-half"></iron-icon>
								<iron-icon class="w3-text-yellow" icon="app:star-half"></iron-icon>
								<iron-icon class="w3-text-yellow" icon="app:star-half"></iron-icon>
								&nbsp;Master Contributor
							</li>
							<li>
								<iron-icon class="w3-text-yellow" icon="app:star"></iron-icon>
								<iron-icon class="w3-text-yellow" icon="app:star"></iron-icon>
								<iron-icon class="w3-text-yellow" icon="app:star"></iron-icon>
								&nbsp;Global Contributor
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		<div id="my-notifications" class="ldp-modal w3-animate-zoom">
			<div class="ldp-modal-content w3-round max-modal-width">
				<div>
					<span id="close-notifications" data="my-notifications" on-click="_closeModal" class="w3-button w3-display-topright w3-medium w3-red w3-text-white">&times;</span>
					<div class="w3-large" style="padding:20px 15px">
						<b class="w3-text-blue"><iron-icon icon="app:notifications"></iron-icon>&nbsp;Notifications</b>
					</div>
					<div class="w3-row">
						<my-notifications user="[[user]]" notificationsdata="[[userNotificationData]]" rootpath=[[rootPath]]></my-notifications>
					</div>
				</div>
			</div>
		</div>

		<div id="my-followers" class="ldp-modal w3-animate-zoom">
			<div class="ldp-modal-content w3-round max-modal-width">
				<div>
					<span id="close-followers" data="my-followers" on-click="_closeModal" class="w3-button w3-display-topright w3-medium">&times;</span>
					<div class="w3-row">
						<my-followers follow="{{follow}}" user="[[user]]"></my-followers>
					</div>
					
				</div>
			</div>
		</div>

		<div id="add-items" class="w3-modal w3-animate-zoom padding-modal-top">
			<div class="w3-modal-content w3-round max-modal-width">
				<div class="w3-container">
					<span id="spanCloseItemModal" on-click="_closeItemsModal" class="w3-button w3-display-topright w3-medium w3-red w3-text-white">&times;</span>
					<div class="w3-large" style="padding:20px 15px">
						<b class="w3-text-blue"><h3>[[itemName]]</h3></b>
					</div>
					<div id="item-holder" class="w3-row w3-padding w3-border w3-round-small w3-margin-bottom"></div>
				</div>
			</div>
		</div>

		<paper-fab-speed-dial id="paperSpeed" with-backdrop style="z-index: 200" hidden$="[[hidemenu]]">
			<paper-fab-speed-dial-action id="fabthoughts" icon="app:message" on-tap="_loadElement1" indexed="add-thoughts" caption="Add Thought">Thought</paper-fab-speed-dial-action>
			<paper-fab-speed-dial-action id="fabarticles" icon="app:remove-red-eye" on-tap="_loadElement1" indexed="add-article" caption="Add Article" hidden$="[[hidesubmenu]]">Article</paper-fab-speed-dial-action>
			<paper-fab-speed-dial-action id="fabvoicemail" icon="app:record-voice-over" on-tap="_loadElement1" indexed="add-voicemail" caption="Add Voicemail" hidden$="[[hidesubmenu]]">Voicemail</paper-fab-speed-dial-action>
			<paper-fab-speed-dial-action id="fabpodcast" icon="app:mic" on-tap="_loadElement1" indexed="add-podcast" caption="Add Podcast" hidden$="[[hidesubmenu]]">Podcast</paper-fab-speed-dial-action>
			<paper-fab-speed-dial-action id="fabvideo" icon="app:videocam" on-tap="_loadElement1" indexed="add-video" caption="Add Video" hidden$="[[hidesubmenu]]">Video</paper-fab-speed-dial-action>
		</paper-fab-speed-dial>

		<div id="snackbar"></div>
		<div class="ldp-modal" id="userProfile">
			<div class="ldp-modal-content" style="max-width:700px">
				<span on-click="_closeUserProfile" class="w3-button w3-display-topright w3-medium w3-red w3-text-white ldp-modal-close">&times;</span>
				<user-profile name="user-profile" _companyid="[[_companyid]]" user="[[user]]" photo="[[photo]]"></user-profile>
			</div>
		</div>
	</template>

	<script>
		var _platform, _guid;
		var nav = window.navigator;
		var _ua = window.navigator.userAgent;
		var scrollTopPosition
		iOS = /iPad|iPhone|iPod/.test(_ua),
		iOS11 = /OS 11_0|OS 11_1|OS 11_2|OS 11_3/.test(_ua);

		var guid = function() {
			var screen = window.screen;
			var guid = nav.mimeTypes.length;
			guid += nav.userAgent.replace(/\D+/g, '');
			guid += nav.plugins.length;
			guid += screen.height || '';
			guid += screen.width || '';
			guid += screen.pixelDepth || '';

			return guid;
		};

		var plat = function() {
			var plat = 'undefined';

			if((/iphone|ipod|ipad/i).test(_ua) && (nav.platform.match(/iPhone|iPod|iPad/i))) plat = 'iOS';
			if((/macintosh/i).test(_ua) && (nav.platform.match(/MacIntel/i))) plat = 'MacOS';
			if((/android/i).test(_ua) && (nav.platform.match(/Linux/i))) plat = 'Android';
			if((/windows nt/i).test(_ua) && (nav.platform.match(/Win32/i))) plat = 'Windows';
			if((/windows phone/i).test(_ua)) plat = 'WindowsPhone';

			if(nav.platform.match(/Win32/i)) plat = 'Windows';
			else if(nav.platform.match(/MacIntel/i)) plat = 'MacOS';
			else if(nav.platform.match(/iPhone|iPod|iPad/i)) plat = 'iOS';
			else if(nav.platform.match(/blackberry/i)) plat = 'BlackBerry';

			return plat;
		};

		_guid = guid();
		_platform = plat();

		class MyApp extends Polymer.Element {
			static get is() { return 'my-app'; }

			ready(){
				super.ready();
				
				var a = Polymer.dom(this.root).querySelectorAll('.drawer-list');
				var that = this;
				var closer = Polymer.dom(this.root).querySelector('#close-side-bar');
				$(a).on('click', 'a.w3-row', function(){
					parent.location.hash = '#';
					if($(closer).is(':visible')){
						that._sideBarClose();
					}
				})

				this._setCompanyTypeSidebar();
				this._setAccountDefaults();
				
				// this.installApp();
			}

			static get properties() {
				return {
					page: {
						type: String,
						reflectToAttribute: true,
						observer: '_pageChanged',
						notify: true
					},
					unread_notifications: {
						type: Number,
						value: 0,
						notify: true
					},
					unread_string: {
						type: String,
						value: "0",
						notify: true
					},
					pending_string: {
						type: String,
						value: "",
						notify: true
					},
					no_followers:{
						type: Number,
						value: 0,
						notify: true
					},
					no_following:{
						type: Number,
						value: 0,
						notify: true
					},
					routeData: Object,
					subroute: String,
					// This shouldn't be neccessary, but the Analyzer isn't picking up
					// Polymer.Element#rootPath
					rootPath: {
						type: String,
						notify: true
					},
					_selected: {
						type: Number,
						value: 0,
						notify: true
					},
					statusKnown: {
						type: Object
					},
					company: {
						type: Object
					},
					_companyPhoto: {
						type: Object
					},
					companyData: {
						type: Object,
						observer: '_onCompanyDataReceived'
					},
					companyPhotos:{
						type: Object,
						observer: '_onCompanyPhotoChange'
					},
					seen: Boolean,
					hidemenu:{
						type: Boolean,
						value: true,
						notify: true
					},
					hidesubmenu:{
						type: Boolean,
						value: true,
						notify: true
					},
					approvethoughts: Boolean,
					hidecompany: Boolean,
					mythoughts: Boolean,
					notcompanyadmin:{
						type: Boolean,
						value: true,
						notify: true
					},
					leadershipapp: {
						type: Boolean,
						value: false,
						notify: true
					},
					publicapp: {
						type: Boolean,
						value: false,
						notify: true
					},
					salesapp: {
						type: Boolean,
						value: false,
						notify: true
					},
					hrapp: {
						type: Boolean,
						value: false,
						notify: true
					},
					_user: {
						type: Object,
						notify: true
					},
					follow: {
						type: String,
						notify: true
					},
					_userID:{
						type: String
					},
					userData: {
						type: Object,
						observer: '_userDataChange'
					},
					userNotificationData: {
						type: Object,
						observer: '_userNotificationDataChange'
					},
					user: {
						type: Object
					},
					photo: {
						type: String
					},
					userLogo:{
						type: String,
						value: "../images/default-user.png"
					},
					companyLogo: {type: String, value: ""},
					companyBgColor: {type: String, value: "background-color:#c3272e"},
					menuTextColor: {type: String, value: "color:#fff"},
					_companyid: String,
					bookAuthor: String,
					bookTitle: String,
					bookBody: String,
					bookPhoto: String,
					previousPage: String,
					ID: String,
					Title: String,
					Subtitle: String,
					aID: String,
					rateType: String,
					orderRateBy: String,
					commentType: String,
					orderCommentBy: String,
					addedit: Number,
				};
			}

			static get observers() {
				return [
					'_routePageChanged(routeData.page)',
				];
			}

			unshortedURL(){
				var expander = {
					expand: function (url, callback) {
						$.ajax({
							dataType: 'text',
							url: url,
							data: {
								format: 'text'
							},
							success: function(response) {
								callback(response);
							}
						});
					}
				};
			//https://t.co/51XZ6kwPyD
				expander.expand( 'http://t.co/NJwI2ugt', function(response) {
					console.log(response.indexOf('URL'));
					console.log(response);
				});
			}

			_openUserProfile(){
				// ios 11 bug caret position
				if ( iOS && iOS11 ) {
					this.addIOSBugfix();
				}
				let modal = Polymer.dom(this.root).querySelector('#userProfile');
				$(modal).css('display', 'block');
			}

			_closeUserProfile(){
				// ios 11 bug caret position
				if ( iOS && iOS11 ) {
					this.removeIOSBugfix();
				}
				let modal = Polymer.dom(this.root).querySelector('#userProfile');
				$(modal).css('display', 'none');
			}

			installApp(){
				addToHomescreen();
			}
			setDeviceType(device){
				let database = firebase.database();
				if(this._user.userID != undefined){
					database.ref('/users/' + this._user.userID + '/deviceTypes').child(device).set(true);
				}
			}
			setDeviceToken(){
				let database = firebase.database();
				var currentToken = localStorage.getItem('currentToken');

				if(this._user != undefined || this._user != null){
					if(currentToken != undefined || currentToken != null){
						database.ref('/users/' + this._user.userID + '/deviceTokens').child(_guid).set(currentToken);
					}
				}
			}
			_objLen(obj) {
				let len = 0;
				if(obj != undefined){
				len = Object.keys(obj).length;
				}
				return len;
			}

			_objLenNotifications(obj) {
				var unread = 0;
				if(obj != undefined){
					
					var notificationsLen = Object.keys(obj).length;

					for (var i = 0; i < notificationsLen; i++) {
						// if(obj[i].seen === false) unread++;						
					}
					// len = Object.keys(obj).length;
				}

				if(unread > 0) return unread;
				return '';
			}

			sendFeedback(){
				var subject = this.$.feedbackSubject.value;
				var message = this.$.feedbackMessage.value;

				var messageVal = this.$.feedbackMessage.validate();
				var subjectVal = this.$.feedbackSubject.validate();

				if(!subject || !subjectVal){
					this.showSnackBar("Feedback Subject required!");
					return;
				}else if(!message || !messageVal){
					this.showSnackBar("Feedback Message required!");
					return;
				}else{
					// Get a reference to the database service
					var database = firebase.database();

					var timeInMs = Date.now();
					// Get a key for a new thought.
					var feedbackID = database.ref().child('feedback').push().key;

					// fix data
					var data = {
						subject: subject,
						message: message,
						companyID: this.user.companyID,
						companyName: this.user.companyName,
						journalUserID: this.user.userID,
						journalUserName: this.user.firstName+" "+this.user.lastName,
						journalUserEmail: this.user.email,
						feedbackID: feedbackID,
						dateRegistered: timeInMs
					}

					// Write the new thought's data
					var updates = {};
					updates['/feedback/' + feedbackID] = data;
					database.ref().update(updates);

					this.$.feedbackSubject.value = "";
					this.$.feedbackMessage.value = "";

					this.showSnackBar("Feedback posted successfully!");

					// close modal
					var modal = Polymer.dom(this.root).querySelector('#send-feedback');
					modal.style.display = 'none';
				}
			}

			_openModal(e){
				// ios 11 bug caret position
				if(e.currentTarget.id == "openFollowing") this.follow = "Following";
				else this.follow = "Followers";

				if ( iOS && iOS11 ) {
					this.addIOSBugfix();
				}
				var modal_name = e.currentTarget.getAttribute('data');
				var modal = Polymer.dom(this.root).querySelector('#'+modal_name);
				modal.style.display = 'block';
			}
			_closeModal(e){
				// ios 11 bug caret position
				if ( iOS && iOS11 ) {
					this.removeIOSBugfix();
				}
				var modal_name = e.currentTarget.getAttribute('data');
				var modal = Polymer.dom(this.root).querySelector('#'+modal_name);
				if(modal_name === 'add-items'){
					this._removeLoadElement();
				}
				else if(modal_name === "my-notifications"){
					let database = firebase.database();
					let seen = false;
					
					database.ref('/users/'+this._userID+'/notifications').orderByChild("seen").equalTo(seen).once('value').then((data)=>{
						var myNotifications = data.val();
						if(myNotifications === null){
							console.log("No notifications");
						}else{
							this._notificationSeen(myNotifications)
						}
						
					}).catch(function(error) {
						console.log("Error updating user notifications:", error);
					});
				}
				modal.style.display = 'none';
			}
			_notificationSeen(nots){
				var myNotifications = {};
				var _userID = this._userID;

				$.each(nots, function(n, nt){
					myNotifications['/users/'+_userID+'/notifications/'+n+'/seen'] = true
				});

				let database = firebase.database();
				database.ref().update(myNotifications);
			}

			isEqual(a, b) {
				console.log(b, a);
				//(a !=="-LDVbbRyIMhukVtTVQ0n")
				if((b == "12345" && a !=="-KgsUcgfo7z1U9MXgd9i") && (b == "12345" && a !=="-LDVbbRyIMhukVtTVQ0n")){
					console.log("true here");
					return true;
				}else return a === b;
			}

			_openItemsModal(){
				// ios 11 bug caret position
				if ( iOS && iOS11 ) {
					this.addIOSBugfix();
				}
				var modal = Polymer.dom(this.root).querySelector('#add-items');
				modal.style.display = 'block';
			}

			_closeItemsModal(){
				// ios 11 bug caret position
				if ( iOS && iOS11 ) {
					this.removeIOSBugfix();
				}
				var modal = Polymer.dom(this.root).querySelector('#add-items');
				this._removeLoadElement();
				modal.style.display = 'none';
			}

			_closeSidebarFromBody(){
				var backBTN = Polymer.dom(this.root).querySelector('#close-side-bar');
				var sidebar = Polymer.dom(this.root).querySelector('#sidebar');
				if($(window).outerWidth() < 780){
					this._sideBarClose();
				}
			}

			_sideBarClicked(){
				var that = this;
				var closer = Polymer.dom(this.root).querySelector('#close-side-bar');
				parent.location.hash = '#';
				if($(closer).is(':visible')){
					that._sideBarClose();
				}
			}

			_sideBarClose(){
				var sidebar = Polymer.dom(this.root).querySelector('#sidebar');
				$(sidebar).animate({'left':'-280px'},200,function(){
					$(sidebar).css('left', '0px');
					$(sidebar).css('display', 'none');
				});
				
				window.onresize = function(){
					if($(window).outerWidth() > 780){
						$(sidebar).css('display', 'block');
					}
				}
			}

			_sideBarOpen(e){
				e.stopPropagation();
				var sidebar = Polymer.dom(this.root).querySelector('#sidebar');
				$(sidebar).css('display', 'block');
				// sidebar.style.display = 'block';
			}

			_routePageChanged(page) {
				// If no page was found in the route data, page will be an empty string.
				// Default to 'view1' in that case.
				var oldpage = this.page;
				this.$.paperSpeed.style.visibility = 'visible';
				window.scrollTo(0, 0);

				if(page == 'leadership-platform' || page == 'components'){
				 this.page = 'company-thoughts';
				 this._selected = 0;
				}else{
				 this.page = page || 'company-thoughts';
				}

				// Close a non-persistent drawer when the page & route are changed.
				// if (!this.$.drawer.persistent) {
				//  this.$.drawer.close();
				// }

				 this._selected = page;
				 var modselect = 0;

				 var showmythoughts = localStorage.getItem("myThoughts");

				 // control the selected tab
				 if(showmythoughts == "false")
					modselect = 1;

				 if(page == 'company-thoughts')
					this._selected = 0;
				 else if(page == 'daily-thoughts')
					this._selected = 1;
				 else if(page == 'leadership-thoughts')
					this._selected = 2;
				 else if(page == 'leadership-articles')
					this._selected = 3 - modselect;
				 else if(page == 'master-class')
					this._selected = 4 - modselect;
				 else if(page == 'topleader-thoughts')
					this._selected = 5 - modselect;
				 else if(page == 'leadership-podcasts')
					this._selected = 6 - modselect;
				 else if(page == 'leadership-videos')
					this._selected = 7 - modselect;
				 else if(page == 'leadership-ebooks')
					this._selected = 8 - modselect;
				 else if(page == 'my-pldp'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'my-pldp') oldpage = 'company-thoughts';
					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";

					this._selected = 9 - modselect;
				 }
				 else if(page == 'company-profile')
					this._selected = 10 - modselect;
				 else if(page == 'company-staff')
					this._selected = 11 - modselect;
				 else if(page == 'thoughts-management'){
					
					if(oldpage == 'thoughts-management') oldpage = 'company-thoughts';
					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
				 }
				 else if(page == 'read-articles'){
					this.$.paperSpeed.style.visibility = 'hidden';
					this.bookAuthor = sessionStorage.getItem("bookAuthor");
					this.bookTitle = sessionStorage.getItem("bookTitle");
					this.bookBody = sessionStorage.getItem("bookBody");
					this.bookPhoto = sessionStorage.getItem("bookPhoto");
					this._selected = 12 - modselect;
				 }
				 else if(page == 'add-thoughts'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'add-thoughts') oldpage = 'company-thoughts';
					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";

					this.addedit = -1;

					this.addedit = sessionStorage.getItem("addedit");
					this._selected = 13;
				 }
				 else if(page == 'add-article'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'add-article') oldpage = 'company-thoughts';

					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
					this._selected = 15;
				 }
				 else if(page == 'user-profile'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'user-profile') oldpage = 'company-thoughts';

					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
					this._selected = 16;
				 }
				 else if(page == 'add-podcast'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'add-podcast') oldpage = 'company-thoughts';

					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
					this._selected = 18;
				 }
				 else if(page == 'add-video'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'add-video') oldpage = 'company-thoughts';

					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
					this._selected = 19;
				 }
				 else if(page == 'about-pldp'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'about-pldp') oldpage = 'company-thoughts';

					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
					this._selected = 20;
				 }
				 else if(page == 'add-voicemail'){
					this.$.paperSpeed.style.visibility = 'hidden';
					if(oldpage == 'add-voicemail') oldpage = 'company-thoughts';

					if(oldpage != undefined)
					  this.previousPage = oldpage;
					else
					  this.previousPage = "company-thoughts";
					this._selected = 21;
				 }

				 // sessionStorage.setItem("_companyid", this._companyid);
			}

			_pageChanged(page) {
				// Load page import on demand. Show 404 page if fails
				this.page = page || 'view1';
				var resolvedPageUrl = this.resolveUrl(page + '.html');
				Polymer.importHref(
						resolvedPageUrl,
						null,
						this._showPage404.bind(this),
						true);
			}

			_showPage404() {
				this.page = 'not-found';
			}

			_photo(photo){
				let photo_url = "background-image: url('../images/default-user.png');";

				if (photo != "" || photo != undefined) { 
					photo_url = 'background-image: url('+photo+');';
				}

				return photo_url;
			}

			_activeChanged(){
				return "Test";
			}

			showSnackBar(msg){
				var x = this.$.snackbar;

				x.innerHTML = msg;

				x.className = "show";
				setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
			}

			_myLoadElement(elementName, htmlImport) {
				// Let's remove last loaded element if exists
				this._removeElement();

				var container = Polymer.dom(this.root).querySelector('#item-holder');
				var __companyid = this._companyid;
				var __user = this.user;
				var previousPage = this.previousPage;
				var company = this.company;

				// Now we load it on-the-fly
				Polymer.importHref(this.resolveUrl(htmlImport), function (e) {
					// Create a new instance
					var myElement = document.createElement(elementName);
					// And add it to the container
					container.appendChild(myElement);
					// Lets set a dummy property just to show how to do it
					myElement._companyid = __companyid;
					myElement.user = __user;
					myElement.company = company;

					if((elementName === "add-thoughts") || (elementName === "add-article") || (elementName === "add-podcast") || (elementName === "add-video") || (elementName === "add-voicemail") ){
						myElement.addedit = 0;
						sessionStorage.setItem("closeElement", false);
					} 
				});
			}

			_activeChanged(){
				return "Test";
			}

			showSnackBar(msg){
				var x = this.$.snackbar;

				x.innerHTML = msg;

				x.className = "show";
				setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
			}

			_loadElement1(e){
				var elem = Polymer.dom(this.root).querySelector('#'+e.target.id);
				var caption = elem.getAttribute('caption');
				var name = elem.getAttribute('indexed');
				this.itemName = caption;

				Polymer.dom(this.root).querySelector('#paperSpeed').style.visibility = 'hidden';

				this._openItemsModal();

				this._myLoadElement(name, name+".html");
			}

			_removeLoadElement(){
				this._removeElement();
				Polymer.dom(this.root).querySelector('#paperSpeed').style.visibility = 'visible';
			}

			_loadElement2 () {
			// Load your element in the next line. Pay attention to the path.
				this._myLoadElement("my-other-element", "elements/myOtherElement.html");
			}

			_removeElement () {
				var container = Polymer.dom(this.root).querySelector('#item-holder');
				// element.removeChild(element.firstChild);

				var element = container.querySelector("*");
				if (element) {
					element.parentNode.removeChild(element);
				}
			}

			_close(){
				this.$.paperSpeed.close();
			}

			_userDataChange(newData, oldData) {
				for (item in newData) {
					if(newData[item] != undefined){
						this._user = newData[item];
						this._userID = newData[item].userID;

						if(this._user.photoURL != undefined || this._user.photoURL) {
							this.photo = this._user.photoURL;
						}else{
							this.photo = "../images/default-user.png";
						}
						
						//Updates the following tab automatically
						var database = firebase.database();
						database.ref('users').child(this._userID).child('following').on('value', (data)=>{
							this.no_following = this._objLen(data.val());

							database.ref('/users/' + this._user.userID).child('analytics').child('following').set(this.no_following);
						})

						database.ref('users').child(this._userID).child('follower').on('value', (data)=>{

							this.no_followers = this._objLen(data.val());
							database.ref('/users/' + this._user.userID).child('analytics').child('followers').set(this.no_followers);
						})

						if(_platform != 'undefined') this.setDeviceType(_platform);

						if((/android|windows|windowsphone/i).test(_platform)) this.setDeviceToken();
					}
					
				}
			}
			
			_userNotificationDataChange(a, b) {
		 		var notifications;
				var unread = 0;

				//Updates the following tab automatically
				var database = firebase.database();
				var that = this;
				let seen = false;

				var notificationsRef = database.ref('/users/'+this._userID+'/notifications').orderByChild("seen").equalTo(seen);

				notificationsRef.on('child_added', function(data) {
					var unread = 0;
					unread++;
					if(unread > 0) that.unread_notifications += unread;

					if(that.unread_notifications > 20) that.unread_string = "20+";
					else that.unread_string = ""+that.unread_notifications;
				});

				notificationsRef.on('child_removed', function(data) {
					var unread = 0;
					unread++;
					if(unread > 0) that.unread_notifications = that.unread_notifications - unread;

					if(that.unread_notifications > 20) that.unread_string = "20+";
					else that.unread_string = ""+that.unread_notifications;
				});
			}

			getContrastYIQ(hexcolor){
				hexcolor = hexcolor.split('#')[1];
				var r = parseInt(hexcolor.substr(0,2),16);
				var g = parseInt(hexcolor.substr(2,2),16);
				var b = parseInt(hexcolor.substr(4,2),16);
				var yiq = ((r*299)+(g*587)+(b*114))/1000;
				return (yiq >= 128) ? '#151515' : 'white';
			}
			
			_addedit(){
				// Add Thought
				this.addedit = 0;
				sessionStorage.setItem("addedit", this.addedit);
				this._close();
			}

			_setAccountDefaults(){
				var primaryColor, companyLogo, menuTextColor;

				primaryColor = localStorage.getItem("primaryColor");
				companyLogo = localStorage.getItem("companyLogo");
				menuTextColor = localStorage.getItem("menuTextColor");
				this.fullName = localStorage.getItem("fullName");
				this.userLogo = localStorage.getItem("userLogo");

				this.companyBgColor = "background-color: "+primaryColor;
				this.updateStyles({'--app-theme-color': primaryColor});
				// this.updateStyles({'--app-menu-text': this.getContrastYIQ(primaryColor)});
				this.companyLogo = companyLogo;
				this.menuTextColor = menuTextColor;
			}

			_setCompanyTypeSidebar(){
				/*
					1 -> Global Leadership App
					2 -> Global Sales App
					3 -> Global HR App
					4 -> Public App
				*/
				var companyType;

				companyType = localStorage.getItem("companyType");

				if(companyType != undefined && companyType === "1"){
					this.leadershipapp = true;
					this.salesapp = false;
					this.hrapp = false;
					this.publicapp = false;
				}
				else if(companyType != undefined && companyType === "2"){
					this.leadershipapp = false;
					this.salesapp = true;
					this.hrapp = false;
					this.publicapp = false;
				}
				else if(companyType != undefined && companyType === "3"){
					this.leadershipapp = false;
					this.salesapp = false;
					this.hrapp = true;
					this.publicapp = false;
				}
				else if(companyType != undefined && companyType === "4"){
					this.leadershipapp = false;
					this.salesapp = false;
					this.hrapp = false;
					this.publicapp = true;
				}
			}

			_onCompanyDataReceived(newData, oldData) {
				for (item in newData) { 
					this.company = newData[item];
					this.companyPhotos = newData[item].photos;
				}

				var database = firebase.database();

				if(newData[0] != undefined){
					/*
						1 -> Global Leadership App
						2 -> Global Sales App
						3 -> Global HR App
						4 -> Public App
					*/
					var companyType = newData[0].companyType;
					localStorage.setItem("companyType", companyType);
					this._setCompanyTypeSidebar();
					this._setAccountDefaults();

					var primaryColor = newData[0].primaryColor;

					this.companyBgColor = "background-color: "+primaryColor;
					this.updateStyles({'--app-theme-color': primaryColor});
					this.companyLogo = newData[0].logo;
					this.menuTextColor = "color: "+this.getContrastYIQ(newData[0].primaryColor);
					// this.updateStyles({'--app-menu-text': this.getContrastYIQ(newData[0].primaryColor)});

					localStorage.setItem("primaryColor", newData[0].primaryColor);
					localStorage.setItem("menuTextColor", this.menuTextColor);
					localStorage.setItem("companyLogo", this.companyLogo);

					var pendingMsgRef = database.ref('dailyThoughts').orderByChild("companyID_status").equalTo(newData[0].companyID+"_pending");
					var unread = 0;
					this.pending_string = "0";
					var that = this;

					pendingMsgRef.on('child_added', function(data) {
						unread++;
						if(unread > 20) that.pending_string = "20+";
						else that.pending_string = ""+unread;
					});

					pendingMsgRef.on('child_removed', function(data) {
						unread--;
						if(unread > 20) that.pending_string = "20+";
						else that.pending_string = ""+unread;
					});

				}

				sessionStorage.setItem("user1", "Subscriber");
				sessionStorage.setItem("user2", "Company Staff");
				sessionStorage.setItem("user3", "Leader");
				sessionStorage.setItem("user4", "Global Contributor");
				sessionStorage.setItem("user5", "Master Contributor");
				sessionStorage.setItem("user6", "Company Admin");
				sessionStorage.setItem("user7", "Platinum Admin");
				sessionStorage.setItem("user8", "Standard User");
				sessionStorage.setItem("user9", "Daily Thoughts");

				sessionStorage.setItem("INTERNAL_DAILY_THOUGHT", "1");
				sessionStorage.setItem("GLOBAL_DAILY_THOUGHT", "2");

				sessionStorage.setItem("DESC_INTERNAL_DAILY_THOUGHT", "Internal Daily Thought");
				sessionStorage.setItem("DESC_GLOBAL_DAILY_THOUGHT", "Global Daily Thought");

				sessionStorage.setItem("APPROVED", "approved");
				sessionStorage.setItem("DECLINED", "declined");
				sessionStorage.setItem("PENDING", "pending");
				sessionStorage.setItem("UNPUBLISHED", "unpublished");
			}
			logout(){
				localStorage.removeItem("companyType");
				localStorage.removeItem("primaryColor");
				localStorage.removeItem("menuTextColor");
				localStorage.removeItem("companyLogo");
				localStorage.removeItem("fullName");
				localStorage.removeItem("userLogo");

				this.$.auth.signOut();
				window.location = '';
				return;
			}
			_onCompanyPhotoChange(newData, oldData){
				for (item in newData) { 
					this._companyPhoto = newData[item];
				}
			}
			addIOSBugfix(){
				// Get scroll position before moving top
				scrollTopPosition = $(document).scrollTop();
				// Add CSS to body "position: fixed"
				$("body").addClass("iosBugFixCaret");
				// $("body").css('position: fixed!important; width: 100%!important;');
			}

			removeIOSBugfix(){
				// Remove CSS to body "position: fixed"
				$("body").removeClass("iosBugFixCaret");

				//Go back to initial position in document
				$(document).scrollTop(scrollTopPosition);
			}
		}

		window.customElements.define(MyApp.is, MyApp);
	</script>

<script src="../data/jquery.min.js"></script>
</dom-module>